
<!DOCTYPE html>
<html lang="lt">
<head>
<meta charset="UTF-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Multipliers ArchetipÅ³ Testas v10.7</title>
<style>
  :root { --bg:#0f172a; --text:#e2e8f0; --card:#1e293b; --accent:#60a5fa; --muted:#94a3b8; }
  .light { --bg:#ffffff; --text:#1f2937; --card:#f1f5f9; --accent:#2563eb; --muted:#6b7280; }
  body { margin:0; font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif; background:var(--bg); color:var(--text); }
  header { position:fixed; top:0; left:0; right:0; background:var(--bg); border-bottom:1px solid var(--card); z-index:100; }
  .bar { max-width:1000px; margin:auto; padding:10px 16px; display:flex; justify-content:space-between; align-items:center; }
  .toolbar { display:flex; gap:8px; flex-wrap:wrap; align-items:center; }
  button { background:var(--accent); color:#fff; border:none; border-radius:8px; padding:8px 12px; font-weight:600; cursor:pointer; }
  button.secondary { background:transparent; color:var(--text); border:1px solid var(--muted); }
  .badge { font-size:.85rem; padding:4px 8px; border-radius:999px; border:1px solid var(--muted); margin-left:8px; }
  main { max-width:1000px; margin:80px auto 24px; padding:0 16px; }
  .grid { display:grid; grid-template-columns:1fr; gap:12px; }
  @media(min-width:1024px){ .grid { grid-template-columns:1.2fr 0.8fr; } }
  .card { background:var(--card); border-radius:12px; padding:12px; }
  .question { margin-bottom:12px; }
  .qtext { margin-bottom:6px; }
  .likert { display:flex; flex-wrap:wrap; gap:8px; }
  .likert label { background: rgba(255,255,255,0.05); border:1px solid rgba(255,255,255,0.12); padding:6px 8px; border-radius:8px; }
  .muted { color:var(--muted); font-size:0.9rem; }
  .archetypes { margin-top:12px; padding:10px; background:rgba(255,255,255,0.05); border-radius:8px; }
  .archetypes p { margin:6px 0; }
  .error { color:#ffb4b4; font-weight:600; margin:8px 0; }
  #resultsCard.highlight { outline: 2px solid var(--accent); box-shadow: 0 0 0 4px rgba(96,165,250,0.25); transition: outline .2s; }
  /* Print lapas */
  .pdf-sheet { display:none; background:#fff; color:#111; padding:20px; font-family: Arial, sans-serif; }
  .pdf-sheet h2 { margin:0 0 10px 0; }
  .pdf-sheet .line { margin:6px 0; }
  .pdf-sheet .small { color:#666; font-size:12px; }
  .pdf-sheet .block { border:1px solid #e5e7eb; border-radius:8px; padding:12px; margin-top:10px; }
  @media print {
    body { -webkit-print-color-adjust: exact; print-color-adjust: exact; }
    header, #quiz, .toolbar { display:none !important; }
    #resultsCard { display:none !important; }
    .pdf-sheet { display:block !important; }
    html, body { background:#fff !important; color:#111 !important; }
  }
</style>
</head>
<body>
<header>
  <div class="bar">
    <div class="title">Multipliers ArchetipÅ³ Testas v10.7</div>
    <div class="toolbar">
      <button id="themeBtn" class="secondary" onclick="toggleTheme()">ğŸŒ™ Tamsi</button>
      <button id="calcBtn" onclick="calculate()">ApskaiÄiuoti</button>
      <button id="resetBtn" class="secondary" onclick="resetAll()">IÅ¡valyti</button>
      <button id="pdfNativeBtn" class="secondary" onclick="pdfNative()">PDF (narÅ¡yklÄ—s)</button>
      <span id="libStatus" class="badge">Bibliotekos: tik Chart.js</span>
    </div>
  </div>
</header>

<main>
  <div class="grid">
    <section class="card" id="quiz">
      <h3>Klausimynas</h3>
      <p id="errorBox" class="error" style="display:none;"></p>
      <p class="muted">25 klausimai (4Ã—5 archetipai + 5 SP kontrolÄ—s). Likerto skalÄ— 1â€“5. Klausimai sumaiÅ¡omi kiekvienÄ… kartÄ….</p>
      <div id="questions"></div>
    </section>

    <aside class="card" id="resultsCard">
      <h3>Rezultatai</h3>
      <div id="summary" class="muted">Kol kas neapskaiÄiuota.</div>
      <div class="card" style="margin-top:12px;">
        <canvas id="radar"></canvas>
      </div>

      <div class="archetypes">
        <h4>ArchetipÅ³ paaiÅ¡kinimai</h4>
        <p><strong>Talent Magnet</strong> â€“ pritraukia ir optimizuoja talentÄ…; Kalbant paprastai - **pastebÄ—k ir pakviesk Å¾mones atsiskleisti**.</p>
        <p><strong>Liberator</strong> â€“ kuria saugiÄ…, bet reikalaujanÄiÄ… erdvÄ™;  Kalbant paprastai -  **leisk klysti, bet aiÅ¡kiai susitark dÄ—l standartÅ³**.</p>
        <p><strong>Challenger</strong> â€“ formuluoja ambicijÄ… ir â€kodÄ—lâ€œ;  Kalbant paprastai - **iÅ¡keli tikslÄ… ir klausi â€kaip padarysime?â€œ**.</p>
        <p><strong>Debate Maker</strong> â€“ kvieÄia skirtingas perspektyvas;  Kalbant paprastai - **prieÅ¡ sprendimÄ… praÅ¡yk faktÅ³ ir nuomoniÅ³**.</p>
        <p><strong>Investor</strong> â€“ deleguoja rezultatÄ… ir suteikia resursus; Kalbant paprastai - **pasakyk rezultatÄ…, duok resursus, susitark dÄ—l patikros**.</p>
      </div>
    </aside>
  </div>
</main>

<!-- Chart.js radarui -->
https://cdnjs.cloudflare.com/ajax/libs/Chart.js/4.4.1/chart.umd.min.js</script>

<script>
/* ====== Tema ====== */
let isLight=false, radar=null;
function toggleTheme(){
  isLight = !isLight;
  document.body.classList.toggle('light', isLight);
  document.getElementById('themeBtn').textContent = isLight ? 'â˜€ï¸ Å viesi' : 'ğŸŒ™ Tamsi';
  document.getElementById('libStatus').textContent = `Bibliotekos: Chart.js ${window.Chart?'âœ“':'âœ—'}`;
}

/* ====== Klausimai ====== */
const Q=[
  {t:'Kai prasideda naujas darbas/projektas, sÄ…moningai ieÅ¡kau Å¾moniÅ³ â€native geniusâ€œ ir skiriu jiems vaidmenis.', w:'TM', ty:'pos'},
  {t:'Reguliariai suteikiu Å¾monÄ—ms augimo galimybiÅ³ (projektai, mentorystÄ—).', w:'TM', ty:'pos'},
  {t:'LinkÄ™s laikyti resursus â€pas saveâ€œ ir nenaudoti naujÅ³ Å¾moniÅ³.', w:'TM', ty:'neg'},
  {t:'Kai komandoje atsiranda â€primadonaâ€œ, aktyviai paÅ¡alinu kliÅ«tÄ¯.', w:'TM', ty:'pos'},
  {t:'Kuriu aiÅ¡kias ribas ir saugiÄ… erdvÄ™, kur Å¾monÄ—s gali klysti.', w:'LB', ty:'pos'},
  {t:'Esu linkÄ™s mikromanaguoti.', w:'LB', ty:'neg'},
  {t:'Kai projektas vÄ—luoja, padedu paÅ¡alinti kliÅ«tis, o ne diktuoju sprendimus.', w:'LB', ty:'pos'},
  {t:'Net kai komanda turi idÄ—jÅ³, daÅ¾nai sprendÅ¾iu pats.', w:'LB', ty:'neg'},
  {t:'DaÅ¾nai keliu komandai tikslus, kurie reikalauja naujÅ³ sprendimÅ³.', w:'CH', ty:'pos'},
  {t:'Vengiu ambicingÅ³ tikslÅ³, kad neperkrauÄiau komandos.', w:'CH', ty:'neg'},
  {t:'Kai keiÄiasi kryptis, aiÅ¡kiai suformuluoju â€kodÄ—lâ€œ.', w:'CH', ty:'pos'},
  {t:'DaÅ¾nai renkuosi saugius sprendimus.', w:'CH', ty:'neg'},
  {t:'PrieÅ¡ sprendimÄ… kvieÄiu skirtingas perspektyvas.', w:'DM', ty:'pos'},
  {t:'Diskusijos baigiasi tuo, kad nusprendÅ¾iu vienas.', w:'DM', ty:'neg'},
  {t:'Kai kyla konfliktas, padedu atskirti â€nuomonÄ™â€œ nuo â€Ä¯rodymÅ³â€œ.', w:'DM', ty:'pos'},
  {t:'Retai praÅ¡au duomenÅ³ prieÅ¡ sprendimÄ….', w:'DM', ty:'neg'},
  {t:'Deleguoju rezultatÄ… ir suteikiu resursus.', w:'IN', ty:'pos'},
  {t:'LinkÄ™s â€uÅ¾baigti patsâ€œ.', w:'IN', ty:'neg'},
  {t:'Po delegavimo praÅ¡au ataskaitos apie rezultatÄ….', w:'IN', ty:'pos'},
  {t:'DaÅ¾nai paskirstau uÅ¾duotis be konteksto.', w:'IN', ty:'neg'},
  {t:'AtsakinÄ—jant Ä¯ apklausas linkÄ™s rinktis kraÅ¡tutines opcijas.', w:'SP', ty:'neutral'},
  {t:'Kartais atsakau â€kaip reikiaâ€œ, o ne â€kaip yraâ€œ.', w:'SP', ty:'neutral'},
  {t:'Esu linkÄ™s skubÄ—ti atsakydamas.', w:'SP', ty:'neutral'},
  {t:'Noriu palikti kuo geresnÄ¯ Ä¯spÅ«dÄ¯.', w:'SP', ty:'neutral'},
  {t:'Kartais sÄ…moningai neatsakau Ä¯ kai kuriuos klausimus.', w:'SP', ty:'neutral'}
];
const labels=['VisiÅ¡kai nesutinku','IÅ¡ dalies nesutinku','Neutralu','IÅ¡ dalies sutinku','VisiÅ¡kai sutinku'];
function shuffle(a){ return a.map(v=>({v, r:Math.random()})).sort((x,y)=>x.r-y.r).map(x=>x.v); }
function render(){
  const c=document.getElementById('questions'); c.innerHTML='';
  shuffle(Q).forEach((q,i)=>{
    const d=document.createElement('div'); d.className='question';
    d.dataset.weight=q.w; d.dataset.type=q.ty; d.dataset.idx=i+1;
    d.innerHTML=`<div class="qtext"><strong>${i+1}.</strong> ${q.t}</div>`;
    const lik=document.createElement('div'); lik.className='likert';
    labels.forEach((L,j)=>{
      const lab=document.createElement('label'); const inp=document.createElement('input');
      inp.type='radio'; inp.name='q'+(i+1); inp.value=(j+1);
      lab.appendChild(inp); lab.appendChild(document.createTextNode(' '+L));
      lik.appendChild(lab);
    });
    d.appendChild(lik); c.appendChild(d);
  });
}

/* ====== Validacija/SkaiÄiavimas ====== */
function read(name){ const nodes=document.getElementsByName(name); for(const n of nodes){ if(n.checked) return parseInt(n.value,10);} return null; }
function validate(){
  let firstMissing = null;
  for(let i=1;i<=Q.length;i++){ if(read('q'+i)===null){ firstMissing = i; break; } }
  const box = document.getElementById('errorBox');
  if(firstMissing){
    box.style.display='block';
    box.textContent = `Atsakykite Ä¯ visus klausimus (trÅ«ksta atsakymo klausime #${firstMissing}).`;
    const el = document.querySelector(`.question [name="q${firstMissing}"]`);
    if(el) el.scrollIntoView({behavior:'smooth', block:'center'});
    return false;
  } else { box.style.display='none'; box.textContent=''; return true; }
}
function compute(){
  const G={TM:0,LB:0,CH:0,DM:0,IN:0}; const C={TM:0,LB:0,CH:0,DM:0,IN:0}; let SPsum=0, SPn=0;
  document.querySelectorAll('.question').forEach(q=>{
    const v=read('q'+q.dataset.idx);
    if(v!=null){
      if(q.dataset.weight==='SP'){ SPsum+=v; SPn++; return; }
      let val=v; if(q.dataset.type==='neg') val=6-v;
      if(val===5) val=5.6; if(val===1) val=1.1;
      G[q.dataset.weight]+=val; C[q.dataset.weight]++;
    }
  });
  for(const k in G){ if(C[k]>0) G[k]=G[k]/C[k]*4; }
  const SP=SPn?(SPsum/SPn):0;
  return {G,SP};
}
function label(k){ return ({TM:'Talent Magnet',LB:'Liberator',CH:'Challenger',DM:'Debate Maker',IN:'Investor'})[k]; }
function spBand(sp){ if(sp <= 2.2) return 'Å¾ema'; if(sp < 3.6) return 'vidutinÄ—'; return 'aukÅ¡ta'; }

/* ====== Paprastos rekomendacijos (be terminÅ³) ====== */
const SIMPLE = {
  TM: [
    'VieÅ¡ai pagirk Å¾mogÅ³ uÅ¾ konkretÅ³ indÄ—lÄ¯.',
    'Pakviesk komandos narÄ¯ pristatyti idÄ—jÄ… susirinkime.',
    'Skirk uÅ¾duotÄ¯, kur Å¾mogus galÄ—tÅ³ parodyti savo stiprybes.'
  ],
  LB: [
    'Pasakyk, kad klaidos yra mokymosi dalis, bet susitarkite dÄ—l standartÅ³.',
    'UÅ¾duok 2â€“3 klausimus prieÅ¡ siÅ«lydamas sprendimÄ….',
    'Kasdien paklausk: â€Kuo galiu padÄ—ti nuimti kliÅ«tis?â€œ'
  ],
  CH: [
    'IÅ¡kelk aiÅ¡kÅ³ tikslÄ… ir paklausk â€kaip padarysime?â€œ',
    'PapraÅ¡yk komandos pasiÅ«lyti bent 2 naujus sprendimus.',
    'Sutark maÅ¾Ä… â€ambicijosâ€œ eksperimentÄ… 2 savaitÄ—ms.'
  ],
  DM: [
    'PrieÅ¡ sprendimÄ… papraÅ¡yk 2 faktÅ³ / Ä¯rodymÅ³.',
    'PapraÅ¡yk skirtingÅ³ nuomoniÅ³ ir uÅ¾raÅ¡yk â€uÅ¾â€œ/â€prieÅ¡â€œ.',
    'Susitarkite dÄ—l sprendimo kriterijÅ³ prieÅ¡ diskusijÄ….'
  ],
  IN: [
    'Deleguodamas pasakyk: â€Svarbiausias rezultatas yraâ€¦â€œ',
    'Duok reikiamus resursus ir terminÄ….',
    'Susitark dÄ—l trumpo patikrinimo (pvz., treÄiadienÄ¯ 10 min.).'
  ]
};
function recommendSimple(G){
  const sorted=Object.entries(G).sort((a,b)=>b[1]-a[1]);
  const [topK,topV] = sorted[0];
  const [lowK,lowV] = sorted[sorted.length-1];
  return {
    top: {k: topK, v: topV, rec: SIMPLE[topK]},
    low: {k: lowK, v: lowV, rec: SIMPLE[lowK]}
  };
}


// ---- Radar pieÅ¡imas: saugi patikra + uÅ¾delstas kvietimas ----
let radar = null;

function drawRadarSafe(G) {
  const canvas = document.getElementById('radar');
  if (!canvas) {
    console.warn('Radar canvas nerastas.');
    return;
  }
  // Chart.js patikra
  if (!window.Chart) {
    const sumDiv = document.getElementById('summary');
    sumDiv.innerHTML += '<br><em>Chart.js neÄ¯keltas â€“ rodoma tekstinÄ— santrauka be grafiko.</em>';
    return;
  }
  // sunaikinti senÄ… chartÄ…
  if (radar) radar.destroy();

  // pieÅ¡ti
  radar = new Chart(canvas, {
    type: 'radar',
    data: {
      labels: ['Talent Magnet','Liberator','Challenger','Debate Maker','Investor'],
      datasets: [{
        label: 'Profilis',
        data: [G.TM||0, G.LB||0, G.CH||0, G.DM||0, G.IN||0],
        borderColor: getComputedStyle(document.body).getPropertyValue('--accent').trim() || '#60a5fa',
        backgroundColor: 'rgba(96,165,250,0.22)'
      }]
    },
    options: {
      responsive: true,
      maintainAspectRatio: false,   // canvas prisitaikys konteineriui
      scales: { r: { suggestedMin: 0, suggestedMax: 20 } }
    }
  });
}

// ---- Inicializacija tik po DOMContentLoaded ----
document.addEventListener('DOMContentLoaded', () => {
  // 1) uÅ¾krauname klausimus
  render();

  // 2) statuso Å¾enkliukas (jei turi)
  const badge = document.getElementById('libStatus');
  if (badge) badge.textContent = `Bibliotekos: Chart.js ${window.Chart ? 'âœ“' : 'âœ—'}`;

  // 3) uÅ¾tikrinti, kad canvas blokas turi aukÅ¡tÄ¯
  const radarCard = document.getElementById('radar').parentElement;
  radarCard.style.minHeight = '320px';
});

// ---- ApskaiÄiuoti: pirma validacija, tada rezultatai + radar ----
function calculate() {
  if (!validate()) return;
  const res = compute();
  showResults(res);            // atnaujina tekstinÄ™ santraukÄ…
  drawRadarSafe(res.G);        // pieÅ¡ia radarÄ… saugiai
}

function formatSummary(res){
  const sum=Object.values(res.G).reduce((a,b)=>a+b,0);
  const bands = sum>=70 ? 'labai Ä¯traukiantis elgesys' : sum>=50 ? 'dalis elgesio yra Multipliers, yra kur tobulÄ—ti' : 'maÅ¾ai Ä¯traukimo â€“ verta stiprinti komandos Ä¯galinimÄ…';
  const R=recommendSimple(res.G);
  return `<strong>Bendras balas:</strong> ${sum.toFixed(1)} / 100 â€” ${bands}<br>
          <strong>Stipriausia:</strong> ${label(R.top.k)} (â‰ˆ${R.top.v.toFixed(1)}); <strong>Silpniausia:</strong> ${label(R.low.k)} (â‰ˆ${R.low.v.toFixed(1)}).<br>
          <strong>SP indeksas:</strong> ${res.SP.toFixed(1)} (${spBand(res.SP)})<br>
          <strong>3 Å¾ingsniai stiprybei (${label(R.top.k)}):</strong> ${R.top.rec.join('; ')}.<br>
          <strong>3 Å¾ingsniai rizikai (${label(R.low.k)}):</strong> ${R.low.rec.join('; ')}.`;
}
function showResults(res){
  drawRadar(res.G);
  document.getElementById('summary').innerHTML = formatSummary(res);
  const card=document.getElementById('resultsCard');
  card.classList.add('highlight');
  card.scrollIntoView({behavior:'smooth', block:'start'});
  setTimeout(()=>card.classList.remove('highlight'),1500);
}

/* ====== Mygtukai ====== */
function calculate(){ if(!validate()) return; const res=compute(); showResults(res); }
function resetAll(){
  document.querySelectorAll('input[type=radio]').forEach(i=>i.checked=false);
  document.getElementById('summary').textContent='Kol kas neapskaiÄiuota.';
  document.getElementById('errorBox').style.display='none';
  if(radar) radar.destroy();
}

/* ====== PDF (narÅ¡yklÄ—s) ====== */
function pdfNative(){
  if(!validate()){ alert('Atsakykite Ä¯ visus klausimus prieÅ¡ generuodami PDF.'); return; }
  const res=compute(); showResults(res);

  let sheet = document.getElementById('pdfSheet');
  if(!sheet){ sheet = document.createElement('div'); sheet.id = 'pdfSheet'; sheet.className = 'pdf-sheet'; document.body.appendChild(sheet); }
  sheet.innerHTML = `
    <h2>Multipliers ataskaita</h2>
    <div class="line">${formatSummary(res).replace(/<br>/g,' ')}</div>
    <div class="block">
      <strong>ArchetipÅ³ paaiÅ¡kinimai (paprasta kalba)</strong><br>
      Talent Magnet â€” pastebÄ—k ir pakviesk Å¾mones atsiskleisti.<br>
      Liberator â€” leisk klysti, susitarkite dÄ—l standartÅ³.<br>
      Challenger â€” iÅ¡kelk â€kodÄ—lâ€œ, kviesk rasti â€kaipâ€œ.<br>
      Debate Maker â€” prieÅ¡ sprendimÄ… praÅ¡yk faktÅ³ ir nuomoniÅ³.<br>
      Investor â€” pasakyk rezultatÄ…, duok resursus, susitark dÄ—l patikros.
    </div>
    <div class="small">Generuota: ${new Date().toLocaleString()}</div>
  `;
  const canvas = document.getElementById('radar');
  if(canvas && window.Chart){
    const img = canvas.toDataURL('image/png', 1.0);
    const imgEl = document.createElement('img');
    imgEl.src = img; imgEl.style.width = '520px'; imgEl.style.display='block'; imgEl.style.marginTop='10px';
    sheet.appendChild(imgEl);
  }
  window.print();
}

/* ====== Inicializacija ====== */
(function init(){
  render();
  document.getElementById('libStatus').textContent = `Bibliotekos: Chart.js ${window.Chart?'âœ“':'âœ—'}`;
})();
</script>
</body>
</html>
